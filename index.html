<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <link rel="apple-touch-icon" href="icon.png">
  <link rel="icon" type="image/png" href="icon.png">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>ğŸŒ™ 365å¤©å­˜éŒ¢è¨ˆç•« ğŸŒ™</title>

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<style>
:root{
  --sky: #0b1220;
  --blue: #89bdf0;
  --glass: rgba(255, 255, 255, 0.08);
  --glass-border: rgba(255, 255, 255, 0.15);
  --gold-glow: rgba(255, 228, 132, 0.5);
}

body{
  margin:0;
  padding:15px;
  font-family:-apple-system,BlinkMacSystemFont,sans-serif;
  background: linear-gradient(135deg, #0b1220 0%, #162447 100%);
  display:flex;
  justify-content:center;
  overflow-x:hidden;
  min-height: 100vh;
}

.stars, .meteors { position:fixed; inset:0; pointer-events:none; z-index:-4; }
.star { position:absolute; background:white; border-radius:50%; animation:twinkle 3s infinite; }
@keyframes twinkle { 0%,100%{opacity:.3} 50%{opacity:1} }
.meteor { position:absolute; width:120px; height:2px; background:linear-gradient(90deg,white,transparent); transform:rotate(-45deg); animation:shoot 1.2s linear forwards; }
@keyframes shoot { from{transform:translate(0,0) rotate(-45deg);opacity:1} to{transform:translate(-600px,600px) rotate(-45deg);opacity:0} }

.moon{
  position:fixed;
  top:-40px;
  right:-40px;
  width:160px;
  height:160px;
  border-radius:50%;
  background: #fffbe6;
  box-shadow:0 0 50px rgba(255,252,220,0.6);
  z-index:-2;
}
.moon::after{
  content:"";
  position:absolute;
  inset:0;
  background:var(--sky);
  border-radius:50%;
  transform:translateX(var(--phase, 0%));
  transition: .8s cubic-bezier(0.4, 0, 0.2, 1);
}

.cloud {
  position: fixed;
  background: radial-gradient(circle at 50% 50%, rgba(255,255,255,0.25) 0%, rgba(255,255,255,0) 70%);
  filter: blur(25px);
  border-radius: 50%;
  z-index: -2;
  animation: float 25s ease-in-out infinite alternate;
}
.c1 { width: 300px; height: 100px; bottom: 15%; left: -50px; }
.c2 { width: 400px; height: 120px; bottom: 30%; right: -100px; animation-delay: -5s; }
@keyframes float { from { transform: translateX(0); } to { transform: translateX(60px); } }

.container{
  background: var(--glass);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  max-width: 500px;
  width: 100%;
  padding: 24px 12px;
  border-radius: 30px;
  border: 1px solid var(--glass-border);
  box-shadow: 0 20px 50px rgba(0,0,0,0.5);
  text-align: center;
  z-index: 1;
}

h1{
  color: #fff;
  font-size: 1.1rem;
  letter-spacing: 2px;
  margin-bottom: 20px;
}

.stats{ display: flex; flex-direction: column; gap: 8px; margin-bottom: 20px; }
.stat{
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: rgba(255,255,255,0.06);
  border-radius: 12px;
  padding: 10px 16px;
  font-size: 13px;
  color: rgba(255,255,255,0.7);
}
.stat span { font-weight: bold; color: var(--blue); font-size: 15px; }

.grid{ display:grid; grid-template-columns: repeat(10, 1fr); gap: 5px; }
.box{
  aspect-ratio:1;
  border-radius: 5px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size: 9px;
  cursor: pointer;
  transition: all 0.3s ease;
  background: rgba(255, 255, 255, 0.05);
  /* èª¿äº®æœªå®Œæˆæ•¸å­—é¡è‰² */
  color: rgba(255, 255, 255, 0.4); 
  border: 1px solid rgba(255, 255, 255, 0.03);
}

.box.selected{
  background: rgba(255, 255, 255, 0.85);
  color: #0b1220;
  font-weight: bold;
  box-shadow: 0 0 12px var(--gold-glow);
  border: 1px solid #fff;
  transform: scale(1.05);
}

/* æ”¾å¤§æ‡¸æµ®é”æˆç‡æŒ‰éˆ• */
.floating{
  position:fixed;
  bottom:30px;
  right:20px;
  width:75px; /* å¾ 60 æ”¾å¤§åˆ° 75 */
  height:75px;
  background: rgba(255,255,255,0.12);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border: 2px solid rgba(255, 228, 132, 0.5); /* åŠ ç²—é‚Šæ¡† */
  border-radius:50%;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  box-shadow: 0 5px 20px rgba(0,0,0,0.3);
  z-index: 10;
}
.floating .val{ font-size:16px; font-weight:800; color:#ffe484; }
.floating .label{ font-size:10px; color: white; opacity:.7; margin-top: 2px; }

.reset{
  margin-top:25px;
  background: none;
  border: none;
  color: rgba(255,255,255,0.25);
  font-size: 11px;
  text-decoration: underline;
  cursor: pointer;
}
</style>
</head>
<body>

<div class="stars" id="stars"></div>
<div class="meteors" id="meteors"></div>
<div class="moon" id="moon"></div>
<div class="cloud c1"></div>
<div class="cloud c2"></div>

<div class="container">
  <h1>ğŸŒ™ 365å¤©å­˜éŒ¢è¨ˆç•« ğŸŒ™</h1>

  <div class="stats">
    <div class="stat">ç´¯è¨ˆ <span>$<span id="currentTotal">0</span></span></div>
    <div class="stat">ç¸½ç›®æ¨™ <span>$<span id="maxTotal">66,795</span></span></div>
    <div class="stat">å®Œæˆé€²åº¦ <span><span id="days">0</span> / 365</span></div>
  </div>

  <div class="grid" id="grid"></div>
  <button class="reset" onclick="resetData()">é‡è¨­é€²åº¦è³‡æ–™</button>
</div>

<div class="floating">
  <div class="val" id="percent">0%</div>
  <div class="label">é”æˆç‡</div>
</div>

<script>
const starsBox = document.getElementById('stars');
for(let i=0; i<80; i++) {
    const star = document.createElement('div');
    star.className = 'star';
    star.style.left = Math.random() * 100 + '%';
    star.style.top = Math.random() * 100 + '%';
    star.style.width = star.style.height = (Math.random() * 2 + 1) + 'px';
    star.style.animationDelay = (Math.random() * 5) + 's';
    starsBox.appendChild(star);
}

const grid=document.getElementById('grid');
const currentTotalEl=document.getElementById('currentTotal');
const maxTotalEl=document.getElementById('maxTotal');
const daysEl=document.getElementById('days');
const percentEl=document.getElementById('percent');
const moon=document.getElementById('moon');
const meteorsBox=document.getElementById('meteors');

const MAX_TOTAL=66795;
let history=JSON.parse(localStorage.getItem('save_365_v2'))||[];
let meteorTimer=null;

function render(){
  grid.innerHTML='';
  const fragment = document.createDocumentFragment();
  for(let i=1;i<=365;i++){
    const d=document.createElement('div');
    d.className='box'+(history.includes(i)?' selected':'');
    d.textContent=i;
    d.onclick=()=>toggle(i);
    fragment.appendChild(d);
  }
  grid.appendChild(fragment);
  update();
}

function toggle(n){
  if(history.includes(n)) history=history.filter(x=>x!==n);
  else history.push(n);
  localStorage.setItem('save_365_v2',JSON.stringify(history));
  render();
}

function update(){
  const sum=history.reduce((a,b)=>a+b,0);
  const count=history.length;
  const dayPercent=count/365;

  currentTotalEl.textContent=sum.toLocaleString();
  daysEl.textContent=count;
  percentEl.textContent=(dayPercent*100).toFixed(1)+'%';

  moon.style.setProperty('--phase', (dayPercent * 100) + '%');
  if(dayPercent===1) startMeteor(); else stopMeteor();
}

function startMeteor(){
  if(meteorTimer) return;
  meteorTimer=setInterval(()=>{
    const m=document.createElement('div');
    m.className='meteor';
    m.style.top=Math.random()*40+'%';
    m.style.left=Math.random()*100+'%';
    meteorsBox.appendChild(m);
    setTimeout(()=>m.remove(),1200);
  },600);
}

function stopMeteor(){
  clearInterval(meteorTimer);
  meteorTimer=null;
}

function resetData(){
  if(confirm('ç¢ºå®šè¦æ¸…é™¤æ‰€æœ‰é€²åº¦å—ï¼Ÿ')){
    history=[];
    localStorage.removeItem('save_365_v2');
    render();
  }
}

render();
</script>

</body>
</html>
